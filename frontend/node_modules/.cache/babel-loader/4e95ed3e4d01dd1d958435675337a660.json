{"ast":null,"code":"import _slicedToArray from\"F:/mess-manager/mess_manager/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Button from\"../../components/Button\";import{listUsers,deleteUser}from\"../../actions/user_actions\";import React,{useState,useEffect,useRef}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import Loader from\"../../components/Loader\";import Message from\"../../components/Message\";import{Link,useLocation,useNavigate}from\"react-router-dom\";import{postAttendance}from\"../../actions/attendance_actions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function MarkAttendance(){var dispatch=useDispatch();var navigate=useNavigate();var myRefForFirstTime=useRef(null);var myRefForSecondTime=useRef(null);var _useSelector=useSelector(function(state){return state.userList;}),users=_useSelector.users,loading=_useSelector.loading,error=_useSelector.error;var today=new Date().toISOString().substr(0,10);var _useSelector2=useSelector(function(state){return state.userLogin;}),userInfo=_useSelector2.userInfo;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),firstTime=_useState2[0],setFirstTime=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),secondTime=_useState4[0],setSecondTime=_useState4[1];var _useState5=useState({id:null,date:today,first_time:\"Present\",second_time:\"Present\"}),_useState6=_slicedToArray(_useState5,2),attenandance=_useState6[0],setAttendance=_useState6[1];useEffect(function(){if(userInfo&&userInfo.isAdmin){dispatch(listUsers());}else{navigate(\"/login\");}},[dispatch,userInfo,navigate]);var handleSubmit=function handleSubmit(e){e.preventDefault();for(var i=0;i<users.length;i++){setAttendance({id:users[i].id,date:today,first_time:firstTime,second_time:secondTime});postAttendance(attenandance);}console.log(myRefForFirstTime.current);console.log(myRefForSecondTime.current);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12 text-dark\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Mark Attendance\"}),\" for \",/*#__PURE__*/_jsx(\"h4\",{children:today}),\"'s meal\"]})}),loading?/*#__PURE__*/_jsx(Loader,{}):error?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"table\",{className:\"table table-bordered\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Room no.\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"First Time\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Second Time\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(function(user){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",name:\"userId\",children:user.id}),/*#__PURE__*/_jsx(\"td\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"table-name\",name:\"username\",value:user.username})}),/*#__PURE__*/_jsx(\"td\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"table-room\",name:\"room\",value:user.room})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{name:\"firstAttendance\".concat(user.id),ref:myRefForFirstTime,onChange:function onChange(e){return e.target.value;},className:\"form-control\",id:\"table-first-time\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"present\",children:\"Present \\u2713\"}),/*#__PURE__*/_jsx(\"option\",{value:\"absent\",children:\"Absent X\"}),/*#__PURE__*/_jsx(\"option\",{value:\"double\",children:\"Double 2\"})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{name:\"secondAttendance\".concat(user.id),ref:myRefForSecondTime,onChange:function onChange(e){return e.target.value;},className:\"form-control\",id:\"table-second-time\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"present\",children:\"Present \\u2713\"}),/*#__PURE__*/_jsx(\"option\",{value:\"absent\",children:\"Absent X\"}),/*#__PURE__*/_jsx(\"option\",{value:\"double\",children:\"Double 2\"})]})})]},user.id);})})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:\"Submit\"})]})]}),/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-12 text-dark\",children:/*#__PURE__*/_jsxs(\"h3\",{children:[today,\"'s totals \"]})})}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-bordered\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Total Members\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Total Absentees\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Total Attendences\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",children:\"1\"}),/*#__PURE__*/_jsx(\"td\",{children:users===null||users===void 0?void 0:users.length}),/*#__PURE__*/_jsx(\"td\",{}),/*#__PURE__*/_jsx(\"td\",{children:\"2\"})]})})]})]})]});}","map":{"version":3,"names":["Button","listUsers","deleteUser","React","useState","useEffect","useRef","useDispatch","useSelector","Loader","Message","Link","useLocation","useNavigate","postAttendance","MarkAttendance","dispatch","navigate","myRefForFirstTime","myRefForSecondTime","state","userList","users","loading","error","today","Date","toISOString","substr","userLogin","userInfo","firstTime","setFirstTime","secondTime","setSecondTime","id","date","first_time","second_time","attenandance","setAttendance","isAdmin","handleSubmit","e","preventDefault","i","length","console","log","current","map","user","username","room","target","value"],"sources":["F:/mess-manager/mess_manager/frontend/src/Screens/admin/markAttendance.js"],"sourcesContent":["\r\nimport Button from \"../../components/Button\";\r\nimport { listUsers, deleteUser } from \"../../actions/user_actions\";\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\n\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport Loader from \"../../components/Loader\";\r\nimport Message from \"../../components/Message\";\r\nimport { Link, useLocation, useNavigate } from \"react-router-dom\";\r\nimport { postAttendance } from \"../../actions/attendance_actions\";\r\n\r\n\r\n\r\nexport default function MarkAttendance() {\r\n\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const myRefForFirstTime = useRef(null)\r\n  const myRefForSecondTime = useRef(null)\r\n\r\n\r\n\r\n\r\n\r\n\r\n  const { users, loading, error } = useSelector((state) => state.userList);\r\n  const today = new Date().toISOString().substr(0, 10);\r\n  const { userInfo } = useSelector((state) => state.userLogin);\r\n  const [firstTime, setFirstTime] = useState('')\r\n  const [secondTime, setSecondTime] = useState('')\r\n  const [attenandance, setAttendance] = useState({ id: null, date: today, first_time: \"Present\", second_time: \"Present\" });\r\n\r\n  useEffect(() => {\r\n    if (userInfo && userInfo.isAdmin) {\r\n      dispatch(listUsers());\r\n\r\n\r\n\r\n    } else {\r\n      navigate(\"/login\");\r\n    }\r\n\r\n  }, [dispatch, userInfo, navigate]);\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n\r\n\r\n\r\n\r\n\r\n    for (let i = 0; i < users.length; i++) {\r\n      setAttendance({ id: users[i].id, date: today, first_time: firstTime, second_time: secondTime });\r\n\r\n      postAttendance(attenandance);\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    console.log(myRefForFirstTime.current)\r\n    console.log(myRefForSecondTime.current)\r\n\r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <>\r\n      <section>\r\n        {/* table for all the users */}\r\n        {/* heading for attendance */}\r\n        <div className=\"row\">\r\n          <div className=\"col-md-12 text-dark\">\r\n            <h3>Mark Attendance</h3> for <h4>{today}</h4>'s meal\r\n          </div>\r\n        </div>\r\n        {loading ? (\r\n          <Loader />\r\n        ) : error ? (\r\n          <Message variant=\"danger\">{error}</Message>\r\n        ) : (\r\n          <form onSubmit={handleSubmit}>\r\n            <table className=\"table table-bordered\">\r\n              <thead>\r\n                <tr>\r\n                  <th scope=\"col\">#</th>\r\n                  <th scope=\"col\">Name</th>\r\n                  <th scope=\"col\">Room no.</th>\r\n                  <th scope=\"col\">First Time</th>\r\n                  <th scope=\"col\">Second Time</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n\r\n                {users.map((user) => (\r\n\r\n\r\n\r\n                  <tr key={user.id}>\r\n\r\n\r\n                    <th scope=\"row\" name=\"userId\">{user.id}</th>\r\n                    <td className=\"form-group\">\r\n                      <input\r\n\r\n                        type=\"text\"\r\n                        className=\"form-control\"\r\n                        id=\"table-name\"\r\n                        name=\"username\"\r\n                        value={user.username}\r\n\r\n                      />\r\n                    </td>\r\n                    <td className=\"form-group\">\r\n                      <input\r\n                        type=\"text\"\r\n                        className=\"form-control\"\r\n                        id=\"table-room\"\r\n                        name=\"room\"\r\n                        value={user.room}\r\n\r\n                      />\r\n\r\n                    </td>\r\n\r\n                    <td>\r\n                      <select name={`firstAttendance${user.id}`} ref={myRefForFirstTime} onChange={(e) => (e.target.value)} className=\"form-control\" id=\"table-first-time\">\r\n                        <option value=\"present\">Present ✓</option>\r\n                        <option value=\"absent\">Absent X</option>\r\n                        <option value=\"double\">Double 2</option>\r\n                      </select>\r\n\r\n                    </td>\r\n                    <td>\r\n                      <select name={`secondAttendance${user.id}`} ref={myRefForSecondTime} onChange={(e) => (e.target.value)} className=\"form-control\" id=\"table-second-time\">\r\n                        <option value=\"present\">Present ✓</option>\r\n                        <option value=\"absent\">Absent X</option>\r\n                        <option value=\"double\">Double 2</option>\r\n                      </select>\r\n\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n\r\n\r\n            </table>\r\n\r\n            <button type=\"submit\" className=\"btn btn-primary\">\r\n              Submit\r\n            </button>\r\n\r\n\r\n          </form>\r\n\r\n        )}\r\n\r\n\r\n\r\n\r\n\r\n      </section >\r\n      <section>\r\n        {/* bootstrap table which shows total attenandance , absentees doubles and total members  */}\r\n        <div className=\"row\">\r\n          <div className=\"col-md-12 text-dark\">\r\n            <h3>{today}'s totals </h3>\r\n          </div>\r\n        </div>\r\n        <table className=\"table table-bordered\">\r\n          <thead>\r\n            <tr>\r\n              <th scope=\"col\">#</th>\r\n              <th scope=\"col\">Total Members</th>\r\n              <th scope=\"col\">Total Absentees</th>\r\n              <th scope=\"col\">Total Attendences</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <th scope=\"row\">1</th>\r\n              <td>{users?.length}</td>\r\n              <td></td>\r\n              <td>2</td>\r\n\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n\r\n\r\n      </section>\r\n    </>\r\n  );\r\n}\r\n\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}